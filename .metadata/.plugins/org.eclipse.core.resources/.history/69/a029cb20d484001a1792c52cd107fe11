package com.mobileproject.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.mobileproject.converter.NewConverter;
import com.mobileproject.dto.ProductDTO;
import com.mobileproject.entity.ProducerEntity;
import com.mobileproject.entity.ProductEntity;
import com.mobileproject.respository.ProducerRespository;
import com.mobileproject.respository.ProductRespository;
import com.mobileproject.service.IProductService;

@Service
public class ProductService implements IProductService {
	
	@Autowired
	private ProductRespository productRespository;
	
	@Autowired
	private ProducerRespository producerRespository;
	
	@Autowired
	private NewConverter newConverter;
	@Override
	public ProductDTO save(ProductDTO productDTO) {
		ProductEntity productEntity = new ProductEntity();
		if(productDTO.getId() !=null) {
			
		}
		ProducerEntity producerEntity = producerRespository.findByCode(productDTO.getProducerCode());
		ProductEntity productEntity = newConverter.toEntity(productDTO);
		productEntity.setProducer(producerEntity);
		productEntity = productRespository.save(productEntity);
		return newConverter.toDTO(productEntity);
	}
	@Override
	public ProductDTO update(ProductDTO productDTO) {
		ProductEntity productEntity = productRespository.findOne(productDTO.getId());
		ProductEntity newProductEntity = newConverter.toEntity(productDTO,productEntity);
		ProducerEntity producerEntity = producerRespository.findByCode(productDTO.getProducerCode());
		productEntity.setProducer(producerEntity);
		productEntity = productRespository.save(productEntity);
		return newConverter.toDTO(productEntity);
	}
	
}
